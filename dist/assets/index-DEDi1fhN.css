:root{color-scheme:dark;--bg: #0b1020;--panel: rgba(255, 255, 255, .06);--panel2: rgba(255, 255, 255, .09);--border: rgba(255, 255, 255, .1);--text: rgba(255, 255, 255, .92);--muted: rgba(255, 255, 255, .7);--good: #22c55e;--bad: #ef4444;--warn: #f59e0b;--accent: #7c3aed;--shadow: 0 18px 60px rgba(0, 0, 0, .55);--r: 14px}*{box-sizing:border-box}html,body{height:100%}body{margin:0;background:radial-gradient(1200px 600px at 10% 20%,rgba(124,58,237,.26),transparent 55%),radial-gradient(900px 500px at 80% 10%,rgba(34,197,94,.12),transparent 52%),radial-gradient(900px 600px at 60% 90%,rgba(59,130,246,.12),transparent 50%),var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";overflow:hidden}a{color:inherit}.container{max-width:1600px;margin:0 auto;padding:22px;height:100vh;display:flex;flex-direction:column;overflow:hidden}.topbar{display:grid;grid-template-columns:1fr auto auto auto;align-items:center;gap:12px;margin-bottom:12px}.brand{display:flex;flex-direction:column;gap:2px;min-width:240px;flex:1 1 auto}.brand h1{font-size:18px;margin:0;letter-spacing:.4px}.brand .sub{font-size:12px;color:var(--muted)}.panel{background:linear-gradient(180deg,#ffffff14,#ffffff0d);border:1px solid var(--border);border-radius:var(--r);box-shadow:var(--shadow)}.toolbar{padding:14px;display:flex;flex-wrap:wrap;gap:12px;align-items:flex-end}.field{display:flex;flex-direction:column;gap:6px;min-width:0}.field label{font-size:12px;color:var(--muted)}.row{display:flex;gap:10px;align-items:center;min-width:0}input[type=text],select{width:100%;border-radius:12px;padding:10px 12px;border:1px solid var(--border);background:#00000038;color:var(--text);outline:none}input[type=text]::placeholder{color:#ffffff73}.btn{border:1px solid var(--border);background:#ffffff0f;color:var(--text);padding:10px 12px;border-radius:12px;cursor:pointer;transition:transform .12s ease,background .12s ease,border .12s ease;-webkit-user-select:none;user-select:none}.btn:hover{background:#ffffff1a}.btn:active{transform:translateY(1px)}.btn.primary{background:#7c3aed4d;border-color:#7c3aed8c}.btn.primary:hover{background:#7c3aed66}.btn.ghost{background:transparent}.toggle{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:12px;border:1px solid var(--border);background:#0000002e}.toggle input{transform:translateY(1px)}.layout{display:grid;grid-template-columns:1fr 440px;gap:16px;margin-top:12px;flex:1 1 auto;min-height:0;overflow:hidden}.layout.landscape{grid-template-columns:1fr;grid-template-rows:1fr minmax(220px,36vh)}.boardWrap{padding:14px;min-height:0;overflow:hidden;display:flex;flex-direction:column}.boardStage{display:flex;justify-content:center;align-items:center;padding:8px;position:relative;flex:1 1 auto;min-height:0;width:100%}.boardOverlayActions{position:absolute;right:10px;top:10px;z-index:40;display:flex;gap:8px}.boardHeader{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:10px;flex-wrap:wrap}.meta{font-size:12px;color:var(--muted)}.board{position:relative;width:auto;height:auto;border-radius:16px;background:#00000038;border:1px solid var(--border);overflow:hidden}.boardContent{position:absolute;top:0;right:0;bottom:0;left:0;transform-origin:0 0}.zoomSelectOverlay{position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none}.zoomCell{position:absolute;border-radius:10px;background:#7c3aed1a;box-shadow:inset 0 0 0 1px #7c3aed38}.zoomCell.hover{background:#f59e0b1a;box-shadow:inset 0 0 0 1px #f59e0b47}.zoomRect{position:absolute;border-radius:12px;border:2px solid rgba(124,58,237,.65);background:#7c3aed1a;box-shadow:inset 0 0 0 1px #ffffff0f}.boardZoomExit{position:absolute;left:10px;top:10px;z-index:45}.tray{padding:14px;display:flex;flex-direction:column;gap:12px;min-height:300px;min-height:0;overflow:hidden}.trayHeader{display:flex;align-items:center;justify-content:space-between}.filtersBar{display:flex;flex-direction:column;gap:10px;padding:10px 12px;border-radius:14px;border:1px solid rgba(255,255,255,.12);background:#00000029}.filtersRow{display:flex;align-items:center;justify-content:flex-start;gap:10px}.filterLabel{display:inline-flex;align-items:center;gap:6px;font-size:13px;color:#ffffffe0;white-space:nowrap}.infoIcon{width:18px;height:18px;border-radius:999px;display:inline-flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;border:1px solid rgba(255,255,255,.16);background:#ffffff14;color:#ffffffb3;cursor:help;-webkit-user-select:none;user-select:none}.piecePreview{border:1px solid rgba(255,255,255,.12);background:#0003;border-radius:16px;padding:10px}.piecePreviewHeader{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:8px}.closeBtn{width:34px;height:34px;padding:0;border-radius:10px}.piecePreviewStage{border-radius:14px;border:1px solid rgba(255,255,255,.1);background:#0003;overflow:hidden;height:240px;display:flex;align-items:center;justify-content:center;position:relative}.piecePreviewStage img{width:100%;height:100%;object-fit:contain;display:block}.loupeWrap{position:absolute;left:10px;bottom:10px;z-index:35;border-radius:14px;border:1px solid rgba(255,255,255,.14);background:#00000059;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);overflow:hidden;box-shadow:var(--shadow)}.loupeCanvas{display:block}.loupeLabel{position:absolute;left:10px;top:8px;font-size:12px;color:#ffffffbf;text-shadow:0 1px 6px rgba(0,0,0,.6)}.trayScroll{flex:1 1 auto;overflow:auto;overflow-x:hidden;padding-right:6px;min-height:0}.trayMain{flex:1 1 auto;min-height:0;display:flex;flex-direction:column;gap:12px}.trayLandscape{flex:1 1 auto;min-height:0;display:grid;grid-template-columns:260px minmax(0,1fr) 340px;gap:12px;align-items:stretch}.trayCol{min-height:0;overflow:hidden;display:flex;flex-direction:column;gap:12px}.trayColPieces .trayScroll{flex:1 1 auto;min-height:0}.trayColSelected .piecePreview{flex:1 1 auto;min-height:0;display:flex;flex-direction:column}.trayColSelected .piecePreviewStage{flex:1 1 auto;height:auto}.trayGrid .piece{width:100%;height:100%}.trayGrid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-auto-rows:var(--tray-tile-h, 90px);gap:var(--tray-gap, 12px);align-content:start;justify-content:stretch}.layout.landscape .trayGrid{grid-template-columns:repeat(auto-fit,minmax(var(--tray-tile-w, 90px),1fr))}@media(max-width:720px){.trayGrid{grid-template-columns:repeat(2,minmax(0,1fr))}}@media(max-width:420px){.trayGrid{grid-template-columns:1fr}}.topbarActions{display:flex;gap:10px;flex-wrap:wrap;align-items:center}.topbarPanel{display:flex;gap:10px;flex-wrap:wrap;align-items:center;padding:10px;border-radius:16px;border:1px solid rgba(255,255,255,.12);background:#00000029}@media(max-width:980px){.topbar{grid-template-columns:1fr;align-items:start}}.gearWrap{position:relative}.gearBtn{width:40px;height:40px;display:inline-flex;align-items:center;justify-content:center;padding:0;border-radius:12px}.settingsPanel{position:fixed;width:320px;border-radius:14px;border:1px solid rgba(255,255,255,.14);background:#0c1020eb;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);box-shadow:var(--shadow);padding:12px;z-index:60;max-height:calc(100vh - 24px);overflow:auto}.settingsRow{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:8px 0;border-bottom:1px solid rgba(255,255,255,.08)}.settingsRow:last-child{border-bottom:none}.settingsRow .left{display:flex;flex-direction:column;gap:3px}.settingsRow .title{font-size:13px;color:#ffffffe6}.settingsRow .hint{font-size:12px;color:#ffffff9e}.colorInput{width:44px;height:34px;border-radius:10px;border:1px solid rgba(255,255,255,.16);background:transparent;padding:0}.modalOverlay{position:fixed;top:0;right:0;bottom:0;left:0;background:#0000009e;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);display:flex;align-items:center;justify-content:center;padding:18px;z-index:50}.modal{width:min(860px,100%);background:linear-gradient(180deg,#ffffff1a,#ffffff0f);border:1px solid rgba(255,255,255,.14);border-radius:18px;box-shadow:var(--shadow);overflow:hidden}.modalHeader{padding:14px 16px;display:flex;align-items:center;justify-content:space-between;gap:12px;border-bottom:1px solid rgba(255,255,255,.1)}.stepper{display:flex;align-items:center;gap:10px;flex-wrap:wrap}.step{display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.12);background:#00000024;font-size:13px;color:#ffffffc7}.stepNum{width:22px;height:22px;border-radius:999px;display:inline-flex;align-items:center;justify-content:center;background:#ffffff1a;border:1px solid rgba(255,255,255,.14);font-weight:700;font-size:12px}.step.active{border-color:#7c3aed8c;background:#7c3aed1f;color:#ffffffeb}.step.done{border-color:#22c55e66;background:#22c55e1a;color:#ffffffe0}.stepSep{width:26px;height:1px;background:#ffffff24}.modalBody{padding:14px 16px 16px;display:grid;grid-template-columns:1.1fr .9fr;gap:14px}.modalFooter{padding:14px 16px;display:flex;justify-content:flex-end;gap:10px;border-top:1px solid rgba(255,255,255,.1)}.modalCard{border:1px solid rgba(255,255,255,.12);background:#0000002e;border-radius:16px;padding:12px}.previewFrame{margin-top:10px;border-radius:14px;border:1px solid rgba(255,255,255,.12);background:#00000038;overflow:hidden;height:280px;display:flex;align-items:center;justify-content:center}.previewFrame img{width:100%;height:100%;object-fit:contain;display:block}.libraryGrid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:10px;max-height:260px;overflow:auto;padding-right:6px}.tabs{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}.tabBtn{border-radius:999px;padding:8px 10px;border:1px solid rgba(255,255,255,.12);background:#00000024;color:#ffffffd1;cursor:pointer}.tabBtn.active{border-color:#7c3aed8c;background:#7c3aed24;color:#ffffffeb}.libraryTopRow{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-top:10px}.subModalOverlay{position:fixed;top:0;right:0;bottom:0;left:0;background:#0000008c;display:flex;align-items:center;justify-content:center;padding:16px;z-index:60}.subModal{width:min(980px,calc(100vw - 32px));max-height:min(86vh,780px);overflow:hidden;border-radius:18px;border:1px solid rgba(255,255,255,.14);background:#0a0a0cf5;box-shadow:0 30px 80px #00000073;display:flex;flex-direction:column}.subModalHeader{padding:14px 16px;display:flex;align-items:center;justify-content:space-between;gap:10px;border-bottom:1px solid rgba(255,255,255,.1)}.subModalBody{padding:14px 16px;overflow:auto}.subModalTitle{font-weight:800;font-size:14px;color:#ffffffeb}.subModalClose{width:34px;height:34px;border-radius:12px;border:1px solid rgba(255,255,255,.14);background:#ffffff0f;color:#ffffffdb;cursor:pointer}.libraryItem{text-align:left;border-radius:14px;border:1px solid rgba(255,255,255,.12);background:#0000002e;padding:8px;cursor:pointer;color:#ffffffeb}.libraryItem:hover{background:#ffffff0f}.libraryItem.selected{border-color:#7c3aed8c;box-shadow:0 0 0 3px #7c3aed29}.libraryThumb{border-radius:12px;overflow:hidden;height:78px;border:1px solid rgba(255,255,255,.1);background:#00000038}.libraryThumb img{width:100%;height:100%;object-fit:cover;display:block}.libraryTitle{margin-top:8px;font-size:12px;color:#fffc;line-height:1.2}@media(max-width:820px){.modalBody{grid-template-columns:1fr}}.piece{position:relative;border-radius:0;border:none;background:transparent;overflow:visible;-webkit-user-select:none;user-select:none;cursor:pointer}.piece.selected{outline:2px solid rgba(124,58,237,.9);outline-offset:2px;z-index:10;filter:drop-shadow(0 14px 34px rgba(124,58,237,.28))}.piece.dimmed{opacity:.55}.pieceRotateBtn{position:absolute;top:6px;left:50%;transform:translate(-50%);z-index:30;border:1px solid rgba(245,158,11,.45);background:#f59e0b1f;color:#fffffff2;padding:6px 10px;border-radius:999px;cursor:pointer;box-shadow:0 10px 26px #00000073,0 0 0 4px #f59e0b1f}.pieceRotateBtn:hover{background:#f59e0b2e}.pieceRotateBtn:active{transform:translate(-50%) translateY(1px)}.piece img{width:100%;height:100%;display:block;object-fit:contain;filter:drop-shadow(0 10px 20px rgba(0,0,0,.45));-webkit-user-drag:none;-webkit-user-select:none;user-select:none}.cell{position:absolute;border-right:1px solid rgba(255,255,255,.05);border-bottom:1px solid rgba(255,255,255,.05)}.cell.placed{border-right:1px solid rgba(255,255,255,.02);border-bottom:1px solid rgba(255,255,255,.02)}.flashGood{animation:flashGood .32s ease}.flashBad{animation:flashBad .36s ease}.flashWarn{animation:flashWarn .36s ease}@keyframes flashGood{0%{box-shadow:0 0 #22c55e00}40%{box-shadow:0 0 0 8px #22c55e47}to{box-shadow:0 0 #22c55e00}}@keyframes flashBad{0%{box-shadow:0 0 #ef444400}40%{box-shadow:0 0 0 10px #ef444438}to{box-shadow:0 0 #ef444400}}@keyframes flashWarn{0%{box-shadow:0 0 #f59e0b00}40%{box-shadow:0 0 0 10px #f59e0b38}to{box-shadow:0 0 #f59e0b00}}.pulseWarn{border-color:#f59e0b8c;box-shadow:0 0 #f59e0b00;animation:pulseWarn .95s ease-in-out infinite}@keyframes pulseWarn{0%{box-shadow:0 0 #f59e0b00}45%{box-shadow:0 0 0 6px #f59e0b29}to{box-shadow:0 0 #f59e0b00}}.hintOverlay{position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none}.hintRect{position:absolute;border-radius:14px;border:2px dashed rgba(124,58,237,.55);background:#7c3aed14;box-shadow:inset 0 0 0 1px #ffffff0f}.progress{height:8px;border-radius:999px;background:#ffffff14;overflow:hidden;border:1px solid rgba(255,255,255,.1)}.progress>div{height:100%;background:linear-gradient(90deg,#7c3aedbf,#22c55ea6);width:0%}@media(max-width:1040px){.toolbar{grid-template-columns:1fr 1fr}.layout{grid-template-columns:1fr}}
